<Window x:Class="PrivacyMonitor.NetworkInterceptor.ReplayModifyWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Replay with modification" Width="720" Height="480" MinWidth="500" MinHeight="360"
        Background="#1E1E2E" WindowStartupLocation="CenterOwner"
        ResizeMode="CanResizeWithGrip">
    <Grid Margin="12">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="60"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <StackPanel Grid.Row="0" Orientation="Vertical" Margin="0,0,0,8">
            <TextBlock Text="Original (read-only) vs Modified (editable). Changes are local until you click Replay."
                       Foreground="#A6ADC8" FontSize="11" TextWrapping="Wrap"/>
            <TextBlock x:Name="RiskPreviewText" Foreground="#F9E2AF" FontSize="10" Margin="0,4,0,0" TextWrapping="Wrap"
                       ToolTip="RiskScore is not recalculated until you click Replay; then response updates the grid."/>
        </StackPanel>
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="6"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <StackPanel Grid.Column="0">
                <TextBlock Text="Original headers" Foreground="#6C7086" FontSize="10" Margin="0,0,0,4"/>
                <TextBox x:Name="OriginalHeadersText" IsReadOnly="True" TextWrapping="NoWrap" VerticalScrollBarVisibility="Auto"
                         FontFamily="Consolas" FontSize="10" Background="#1E1E2E" Foreground="#A6ADC8" BorderThickness="0" Padding="6"/>
            </StackPanel>
            <GridSplitter Grid.Column="1" Width="6" HorizontalAlignment="Stretch" Background="#45475A"/>
            <StackPanel Grid.Column="2">
                <TextBlock Text="Modified headers (editable)" Foreground="#6C7086" FontSize="10" Margin="0,0,0,4"/>
                <DataGrid x:Name="HeadersGrid" AutoGenerateColumns="False" CanUserAddRows="True" CanUserDeleteRows="True"
                          HeadersVisibility="Column" GridLinesVisibility="Horizontal" RowHeight="24" FontSize="10"
                          Background="#313244" RowBackground="#313244" AlternatingRowBackground="#45475A"
                          BorderThickness="0">
                    <DataGrid.RowStyle>
                        <Style TargetType="DataGridRow">
                            <Setter Property="Background" Value="Transparent"/>
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsModified}" Value="True">
                                    <Setter Property="Background" Value="#3D3A2E"/>
                                    <Setter Property="ToolTip" Value="Modified from original"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </DataGrid.RowStyle>
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Name" Binding="{Binding Key}" Width="*"/>
                        <DataGridTextColumn Header="Value" Binding="{Binding Value}" Width="2*"/>
                    </DataGrid.Columns>
                </DataGrid>
            </StackPanel>
        </Grid>
        <TextBlock Grid.Row="2" Text="Request body (optional; for POST/PUT):" Foreground="#A6ADC8" FontSize="10" Margin="0,6,0,2"/>
        <TextBox x:Name="BodyBox" Grid.Row="3" AcceptsReturn="True" TextWrapping="Wrap" VerticalScrollBarVisibility="Auto"
                 FontFamily="Consolas" FontSize="11" Background="#313244" Foreground="#CDD6F4" BorderThickness="1" BorderBrush="#45475A"
                 Margin="0,0,0,8"/>
        <StackPanel Grid.Row="4" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,8,0,0">
            <Button Content="Cancel" IsCancel="True" Width="80" Padding="8,4" Margin="0,0,8,0" Click="Cancel_Click"/>
            <Button Content="Replay" IsDefault="True" Width="80" Padding="8,4" Click="Replay_Click" ToolTip="Send this modified request; response will update grid and recalc RiskScore."/>
        </StackPanel>
    </Grid>
</Window>
